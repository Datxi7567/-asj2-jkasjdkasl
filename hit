_G.Kill_Aura = true

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")

local player = Players.LocalPlayer
local remote = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("MeleeHitTarget")

local attackType = "SLASH"
local weaponName = "SW-2_LastHope"
local attackInterval = 0.2 -- Mỗi 0.2s thực hiện 1 đợt tấn công toàn bộ

task.spawn(function()
    while _G.Kill_Aura do
        local character = player.Character
        if not character then continue end

        local enemiesFolder = workspace:FindFirstChild("Enemies")
        if not enemiesFolder then continue end

        for _, enemy in pairs(enemiesFolder:GetChildren()) do
            local hrp = enemy:FindFirstChild("HumanoidRootPart")
            local humanoid = enemy:FindFirstChild("Humanoid")

            if hrp and humanoid and humanoid.Health > 0 then
                task.spawn(function()
                    local args = {
                        character,
                        attackType,
                        hrp.CFrame,
                        weaponName
                    }

                    pcall(function()
                        remote:InvokeServer(unpack(args))
                    end)
                end)
            end
        end

        task.wait(attackInterval)
    end
end)
